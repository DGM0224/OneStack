<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
  <meta charset="UTF-8">
  <title>비활성화 관리</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/adminPage.css">
</head>
<body>
<!-- 회원인 경우 -->
<div th:unless="${session.member.isAdmin}">
  <button class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#reportModal">신고</button>
</div>

<!-- 신고 모달 -->
<div class="modal fade" id="reportModal" tabindex="-1" aria-labelledby="reportModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="reportModalLabel">신고하기</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form th:action="@{/report}" method="post">
        <div class="modal-body">
          <input type="hidden" name="memberNo" th:value="${session.member.memberNo}" />
          <input type="hidden" name="reportedMemberNo" th:value="${member?.memberNo ?: 3}" />

          <div class="mb-3">
            <label for="reportsType" class="form-label">신고 유형</label>
            <select id="reportsType" name="reportsType" class="form-select">
              <option value="community">자유게시판</option>
              <option value="qna">질문게시판</option>
              <option value="reply">댓글</option>
              <option value="review">리뷰</option>
            </select>
          </div>

          <div class="mb-3">
            <label for="reportsTarget" class="form-label">신고 항목</label>
            <select id="reportsTarget" name="reportsTarget" class="form-select">
              <option value="욕설">욕설</option>
              <option value="광고">광고</option>
              <option value="스팸">스팸</option>
              <option value="기타">기타</option>
            </select>
          </div>

          <div class="mb-3">
            <label for="reportsReason" class="form-label">신고 사유</label>
            <textarea id="reportsReason" name="reportsReason" class="form-control" rows="3" placeholder="신고 사유를 작성해주세요"></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
          <button type="submit" class="btn btn-primary">신고 접수</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- 관리자 비활성화 관리 -->
<div th:if="${session.member.isAdmin}">
  <!-- 질문 게시글 비활성화 -->
  <form th:action="@{/disable}" method="post">
    <input type="hidden" name="type" value="qna"> <!-- 유형 -->
    <input type="hidden" name="no" th:value="${QnA.qnaBoardNo}">
    <button type="submit" class="btn btn-warning">질문 게시글 비활성화</button>
  </form>

  <!-- 전체 게시글 비활성화 -->
  <form th:action="@{/disable}" method="post">
    <input type="hidden" name="type" value="post"> <!-- 유형 -->
    <input type="hidden" name="no" th:value="${Community.communityBoardNo}">
    <button type="submit" class="btn btn-warning">전체 게시글 비활성화</button>
  </form>

  <!-- 전체 게시글 댓글 비활성화 -->
  <form th:action="@{/disable}" method="post">
    <input type="hidden" name="type" value="comment"> <!-- 유형 -->
    <input type="hidden" name="no" th:value="${CommunityReply.communityReplyNo}">
    <button type="submit" class="btn btn-warning">댓글 비활성화</button>
  </form>

  <!-- QnA 댓글 비활성화 -->
  <form th:action="@{/disable}" method="post">
    <input type="hidden" name="type" value="qnaComment"> <!-- 유형 -->
    <input type="hidden" name="no" th:value="${QnAReply.qnaReplyNo}">
    <button type="submit" class="btn btn-warning">QnA 댓글 비활성화</button>
  </form>

  <!-- 리뷰 비활성화 -->
  <form th:action="@{/disable}" method="post">
    <input type="hidden" name="type" value="review"> <!-- 유형 -->
    <input type="hidden" name="no" th:value="${Review.reviewNo}">
    <button type="submit" class="btn btn-warning">리뷰 비활성화</button>
  </form>
</div>


<!--<script>-->
<!--&lt;!&ndash;회원 신고 접수 &ndash;&gt;-->
<!--  document.getElementById("submitReport").addEventListener("click", function () {-->
<!--    const reportedMemberNo = parseInt(document.getElementById("reportedMemberNo").value, 10); // 신고자 ID-->
<!--    const memberNo = parseInt(document.getElementById("memberNo").value, 10); // 신고 대상 ID-->
<!--    const reportsType = document.getElementById("reportsType").value; // 신고 유형-->
<!--    const reportsTarget = document.getElementById("reportsTarget").value; // 신고 항목-->
<!--    const reportsReason = document.getElementById("reportsReason").value; // 신고 사유-->
<!--    const reportsLink = window.location.href; // 현재 페이지 URL-->

<!--    // 데이터 객체 생성-->
<!--    const reportData = {-->
<!--      memberNo,-->
<!--      reportedMemberNo,-->
<!--      reportsType,-->
<!--      reportsTarget,-->
<!--      reportsTargetLink: reportsLink,-->
<!--      reportsReason,-->
<!--      reportsLink,-->
<!--    };-->

<!--    // 데이터 검증 (필요한 경우)-->
<!--    if (!reportedMemberNo || !memberNo || !reportsType || !reportsTarget || !reportsReason) {-->
<!--      alert("모든 필드를 입력해주세요.");-->
<!--      return;-->
<!--    }-->
<!--    // AJAX 요청-->
<!--    fetch("/report", {-->
<!--      method: "POST",-->
<!--      headers: {-->
<!--        "Content-Type": "application/json",-->
<!--      },-->
<!--      body: JSON.stringify(reportData),-->
<!--    })-->
<!--            .then((response) => {-->
<!--              if (response.ok) {-->
<!--                return response.text().then((message) => {-->
<!--                  alert(message);-->
<!--                  location.reload();-->
<!--                });-->
<!--              } else {-->
<!--                    return response.text().then((error) => {-->
<!--                      console.error("Error Response:", error);-->
<!--                      console.log("Report Data:", reportData);-->
<!--                      alert(`신고 접수 실패: ${error}`);-->
<!--                });-->
<!--              }-->
<!--            })-->
<!--            .catch((error) => {-->
<!--              console.error("Error:", error);-->
<!--              alert("서버와의 통신 중 오류가 발생했습니다.");-->
<!--            });-->
<!--  });-->
<!--</script>-->
</body>
</html>
